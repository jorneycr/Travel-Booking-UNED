@model RutaBus
@{
    ViewBag.Title = "Detalles de la Ruta";
}
<h2>Detalles de la Ruta</h2>

<!-- Mostrar mensajes de éxito o error -->
@if (TempData["Success"] != null)
{
    <p style="color: green;">@TempData["Success"]</p>
}
@if (TempData["Error"] != null)
{
    <p style="color: red;">@TempData["Error"]</p>
}

<div>
    <h3>@Model.Origen - @Model.Destino</h3>
    <p>Fecha: @Model.Fecha.ToString("dd/MM/yyyy")</p>
    <p>Hora de Salida: @Model.HoraSalida</p>
    <p>Hora de Llegada: @Model.HoraLlegada</p>
    <p>Precio: @Model.Precio.ToString("C")</p>
    <p>Información del Autobús: @Model.BusInfo</p>
</div>

<h4>Disponibilidad de Asientos</h4>
<form id="seatSelectionForm" method="post" action="/Pago/ProcesarPago">
    <input type="hidden" name="rutaId" value="@Model.Id" />
    <input type="hidden" id="asientosSeleccionados" name="asientosSeleccionados" />
    <ul>
        @foreach (var asiento in Model.Asientos)
        {
            <li>
                <label>
                    <input type="checkbox" class="asientoCheckbox" value="@asiento.Numero" @(asiento.Disponible ? "" : "disabled") />
                    Asiento @asiento.Numero - @(asiento.Disponible ? "Disponible" : "No disponible")
                </label>
            </li>
        }
    </ul>
    <button type="submit">Reservar Asientos Seleccionados</button>
</form>

<script>
    document.getElementById('seatSelectionForm').addEventListener('submit', function(event) {
        // Obtener asientos seleccionados
        const selectedSeats = Array.from(document.querySelectorAll('.asientoCheckbox:checked'))
                                   .map(checkbox => checkbox.value);
        
        if (selectedSeats.length === 0) {
            event.preventDefault();
            alert("Por favor, selecciona al menos un asiento para reservar.");
        } else {
            // Pasar asientos seleccionados al campo oculto
            document.getElementById('asientosSeleccionados').value = selectedSeats.join(',');
        }
    });
</script>
